<!DOCTYPE html>
<html lang="ja" class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width">
<title></title>
<style>
body{margin: 0;padding: 0;}
canvas{display: block;}
</style>
</head>
<body>

<div id="bg"></div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<!-- <script src="createjs-2013.05.14.min.js"></script> -->
<script src="http://code.createjs.com/easeljs-0.6.1.min.js"></script>
<script>

var RAF = ( function(){
  return window.requestAnimationFrame       ||
         window.webkitRequestAnimationFrame ||
         function( callback ){
             window.setTimeout( callback, 1000.0 / 60.0 );
         };
} )();


var $el = $( '#bg' );
var $canvas = $( '<canvas/>' );
$el.append( $canvas );
$canvas.attr( {
  'width' : window.innerWidth,
  'height': window.innerHeight
} );
ctx = $canvas[ 0 ].getContext( '2d' );

var x1 = 200;
var y1 = 200;
var x2 = 100;
var y2 = 100;
var timestamp = Date.now();

( function drawPoints () {
  var now = Date.now();
  var elapsedTime = now - timestamp;
  if( elapsedTime < 2300 ) {
    requestAnimationFrame( drawPoints );
  }
  $canvas[ 0 ].width = $canvas[ 0 ].width;
  var lengthOfLine = Math.min( now - timestamp, 100 ) / 100;
  var m = lengthOfLine;
  var n = 1 - lengthOfLine;
  var x = n * x1 + m * x2;
  var y = n * y1 + m * y2;
  var grad = getGrad( x1, y1, x, y, lengthOfLine, elapsedTime );

  ctx.save();
  ctx.beginPath();
  ctx.lineWidth = 1;
  ctx.moveTo( x1, y1 );
  ctx.lineTo( x, y );
  ctx.closePath();
  ctx.strokeStyle = grad;
  ctx.stroke();
  ctx.restore();

  function getGrad( x1, y1, x2, y2, lengthOfLine, elapsedTime ) {
    var COLOR1 = [ 82, 204, 186 ];
    var COLOR2 = [ 255, 248, 59 ];
    var color = [];

    var grad  = ctx.createLinearGradient( x1, y1, x2, y2 );
    if ( lengthOfLine < 1 ) {
      // 線が伸び途中（100%未満）
      grad.addColorStop( 0, 'rgb(' + COLOR2.join() + ')' );
      grad.addColorStop( 1, 'rgb(' + COLOR1.join() + ')' );
    } else if( elapsedTime < 1300 ) {
      // 線が伸び切った後のグラデーション -> 単色
      var percentage = ( 1300 - elapsedTime ) / 1000;
      for ( var i = 0; i < 3; i ++ ) {
        color[ i ] = ( COLOR2[ i ] + ( COLOR1[ i ] - COLOR2[ i ] ) * percentage )|0;
      }
      grad.addColorStop( 0, 'rgb(' + COLOR2.join() + ')' );
      grad.addColorStop( 1, 'rgb(' + color.join() + ')' );
    } else {
      // 単色 -> フェードアウト
      var alpha = ( 2300 - elapsedTime ) / 2000;
      console.log( alpha );
      grad = 'rgba(' + COLOR2.join() + ',' + alpha + ')';
    }
    return grad;
  }


} )();




</script>


</body>
</html>